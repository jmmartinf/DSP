<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="José María Martín" />

<meta name="date" content="2024-08-06" />

<title>Exam DataCamp</title>

<script src="Exam_files/header-attrs-2.28/header-attrs.js"></script>
<script src="Exam_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="Exam_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="Exam_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="Exam_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="Exam_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="Exam_files/navigation-1.1/tabsets.js"></script>
<link href="Exam_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="Exam_files/highlightjs-9.12.0/highlight.js"></script>
<script src="Exam_files/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="Exam_files/d3-3.3.8/d3.min.js"></script>
<script src="Exam_files/dagre-0.4.0/dagre-d3.min.js"></script>
<link href="Exam_files/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet" />
<script src="Exam_files/mermaid-0.3.0/dist/mermaid.slim.min.js"></script>
<link href="Exam_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="Exam_files/chromatography-0.1/chromatography.js"></script>
<script src="Exam_files/DiagrammeR-binding-1.0.11/DiagrammeR.js"></script>
<script src="Exam_files/kePrint-0.0.1/kePrint.js"></script>
<link href="Exam_files/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div id="header">



<h1 class="title toc-ignore">Exam DataCamp</h1>
<h4 class="author">José María Martín</h4>
<h4 class="date">2024-08-06</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#setup" id="toc-setup"><span
class="toc-section-number">1</span> Setup</a>
<ul>
<li><a href="#packages" id="toc-packages"><span
class="toc-section-number">1.1</span> Packages</a></li>
<li><a href="#import-data" id="toc-import-data"><span
class="toc-section-number">1.2</span> Import Data</a></li>
<li><a href="#code" id="toc-code"><span
class="toc-section-number">1.3</span> Code</a></li>
</ul></li>
<li><a href="#data-analysis-framework"
id="toc-data-analysis-framework"><span
class="toc-section-number">2</span> Data Analysis Framework</a>
<ul>
<li><a href="#questionproblem-statement"
id="toc-questionproblem-statement"><span
class="toc-section-number">2.1</span> Question/Problem
Statement</a></li>
<li><a href="#structure-of-information"
id="toc-structure-of-information"><span
class="toc-section-number">2.2</span> Structure of Information</a></li>
<li><a href="#workflow" id="toc-workflow"><span
class="toc-section-number">2.3</span> Workflow</a></li>
</ul></li>
<li><a href="#preliminary-analysis" id="toc-preliminary-analysis"><span
class="toc-section-number">3</span> Preliminary Analysis</a>
<ul>
<li><a href="#load-data" id="toc-load-data"><span
class="toc-section-number">3.1</span> Load Data</a></li>
<li><a href="#data-validation" id="toc-data-validation"><span
class="toc-section-number">3.2</span> Data Validation</a>
<ul>
<li><a href="#missing-values" id="toc-missing-values"><span
class="toc-section-number">3.2.1</span> Missing Values</a></li>
<li><a href="#text-variables-validation"
id="toc-text-variables-validation"><span
class="toc-section-number">3.2.2</span> Text Variables
Validation</a></li>
<li><a href="#numeric-variables-validation"
id="toc-numeric-variables-validation"><span
class="toc-section-number">3.2.3</span> Numeric Variables
Validation</a></li>
</ul></li>
<li><a href="#exploratory-analysis" id="toc-exploratory-analysis"><span
class="toc-section-number">3.3</span> Exploratory Analysis</a>
<ul>
<li><a href="#dataset-overview" id="toc-dataset-overview"><span
class="toc-section-number">3.3.1</span> Dataset Overview</a></li>
<li><a href="#variable-classification"
id="toc-variable-classification"><span
class="toc-section-number">3.3.2</span> Variable Classification</a></li>
<li><a href="#target-description" id="toc-target-description"><span
class="toc-section-number">3.3.3</span> Target Description</a></li>
<li><a href="#numeric-variables-exploration"
id="toc-numeric-variables-exploration"><span
class="toc-section-number">3.3.4</span> Numeric Variables
Exploration</a></li>
<li><a href="#categorical-variables"
id="toc-categorical-variables"><span
class="toc-section-number">3.3.5</span> Categorical Variables</a></li>
<li><a href="#outliers" id="toc-outliers"><span
class="toc-section-number">3.3.6</span> Outliers</a></li>
</ul></li>
</ul></li>
<li><a href="#pre-processing-analysis"
id="toc-pre-processing-analysis"><span
class="toc-section-number">4</span> Pre-Processing Analysis</a>
<ul>
<li><a href="#correlation" id="toc-correlation"><span
class="toc-section-number">4.1</span> Correlation</a>
<ul>
<li><a href="#high-correlated-variables-vs-target-variable"
id="toc-high-correlated-variables-vs-target-variable"><span
class="toc-section-number">4.1.1</span> High Correlated Variables vs
Target Variable</a></li>
<li><a href="#anova-and-post-hoc-tests"
id="toc-anova-and-post-hoc-tests"><span
class="toc-section-number">4.1.2</span> ANOVA and post-hoc
tests</a></li>
</ul></li>
<li><a href="#transformations" id="toc-transformations"><span
class="toc-section-number">4.2</span> Transformations</a></li>
</ul></li>
<li><a href="#machine-leaning-models-analysis"
id="toc-machine-leaning-models-analysis"><span
class="toc-section-number">5</span> Machine Leaning Models Analysis</a>
<ul>
<li><a href="#workflow-1" id="toc-workflow-1"><span
class="toc-section-number">5.1</span> Workflow</a></li>
<li><a href="#results" id="toc-results"><span
class="toc-section-number">5.2</span> Results</a></li>
<li><a href="#average-predictions" id="toc-average-predictions"><span
class="toc-section-number">5.3</span> Average Predictions</a></li>
<li><a href="#residuals" id="toc-residuals"><span
class="toc-section-number">5.4</span> Residuals</a></li>
<li><a href="#accuracy" id="toc-accuracy"><span
class="toc-section-number">5.5</span> Accuracy</a></li>
</ul></li>
<li><a href="#sessioninfosession_info"
id="toc-sessioninfosession_info"><span
class="toc-section-number">6</span> sessioninfo::session_info()</a></li>
</ul>
</div>

<!-- Bloque de CSS  -->
<style>
.lightable-classic {
  margin: 0px 5px 25px !important;  /* Ajusta el margen inferior a 20px */
}
</style>
<div id="setup" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Setup</h1>
<div id="packages" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Packages</h2>
</div>
<div id="import-data" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Import Data</h2>
</div>
<div id="code" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Code</h2>
<p>The code, output datasets, and diagrams are arranged in parallel with
the index of this document.</p>
<pre><code>## ¦   .gitignore
## ¦   .Rhistory
## ¦   DSP.Rproj
## ¦   Exam.html
## ¦   Exam.Rmd
## ¦   README.md
## ¦   
## +---data
## ¦       01_raw.rds
## ¦       02_validated.RData
## ¦       03_explore.RData
## ¦       04_correlations.RData
## ¦       06_metrics.RData
## ¦       06_models.RData
## ¦       
## +---figures
## ¦       05_categorical_distr_plot.png
## ¦       06_residuals_histogram.png
## ¦       06_residuals_qqplot.png
## ¦       06_response_prediction.png
## ¦       
## +---scripts
##         01_load.R
##         02_validations.R
##         03_explore.R
##         04_correlations.R
##         05_aov.R
##         06_machine_learning_models.R
## </code></pre>
</div>
</div>
<div id="data-analysis-framework" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Data Analysis
Framework</h1>
<div id="questionproblem-statement" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Question/Problem
Statement</h2>
<p>This document will describe each step of the process that allows
achieving the objectives of the exercise, both trivial aspects and
aspects related to decision-making with a subjective component.</p>
<blockquote>
<p>The objective is to complete the exercise requirements, which involve
analyzing the data, modeling the used vehicle price estimation with an
accuracy within 10%, and sharing the results.</p>
</blockquote>
</div>
<div id="structure-of-information" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Structure of
Information</h2>
<p>Each step of the process is performed using R code in files located
in the <em>scripts</em> folder, numbered to follow a reading sequence.
The input information and summary of the analysis processes are located
in the <em>data</em> folder and in the <em>figures</em> folder. This
document serves as a presentation layer for the results.</p>
<p>This exercise uses Tidiverse as ecosystem for data analysis, also
consistent withe <a href="https://style.tidyverse.org/">Tidyverse style
guide</a>. For modelling takes an approach not featured in the DataCamp
courses, Tidymodels, although it is mentioned in one blog.</p>
</div>
<div id="workflow" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Workflow</h2>
<div id="htmlwidget-3b41ca56791b213c809c" style="width:100%;height:100px;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-3b41ca56791b213c809c">{"x":{"diagram":"\n    graph LR\n        A[Preliminary Analysis]\n        B[Exploratory Analysis]\n        C[Pre-Processing Analysis]\n        D[Machine Learning Modelling]\n        \n        A --> B\n        B --> C\n        C --> D\n    "},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="preliminary-analysis" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Preliminary
Analysis</h1>
<div id="htmlwidget-358806f8c3c9e78b2081" style="width:100%;height:100%;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-358806f8c3c9e78b2081">{"x":{"diagram":"\n    graph LR\n        A[Load Data<br><small>./scripts/01_load.R<\/small>]\n        A --> B[Data Validation<br><small>./scripts/02_validations.R<\/small>]\n        B --> C[Exploratory Analysis<br><small>./scripts/03_explore.R<\/small>]\n    "},"evals":[],"jsHooks":[]}</script>
<div id="load-data" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Load Data</h2>
<p>The script in the file <em>01_load_data.R</em> loads the dataset in
CSV format, from the <a
href="https://s3.amazonaws.com/talent-assets.datacamp.com/toyota.csv">path</a>
(indicated in the exercise), performs a minimal transformation to
contain the information in an object of the <em>dataframe</em> class,
and saves the data in the file <em>01_raw.rds</em> for later use in the
<em>data</em> folder.</p>
</div>
<div id="data-validation" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Data Validation</h2>
<p>The analysis aimed at analyzing the quality of the data is carried
out in the file <em>02_validation.R</em>, performing the following
actions:</p>
<div id="htmlwidget-5e0aeced447dfb5c987a" style="width:100%;height:100%;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-5e0aeced447dfb5c987a">{"x":{"diagram":"\n    graph TB\n        A[Identify NA values] \n        A --> B[Validation on Categorical Variables] \n        B --> C[Check unique text by categorical variables] \n        C --> D[Factorize Text Variables] \n        A --> E[Validation on Numeric Variables] \n        E --> F[Negative values check] \n        F --> G[Zero values check] \n        G --> H[Corrections on <i>engineSize<\/i> = 0] \n        H --> I[Save corrected Dataset] \n        D --> I\n    "},"evals":[],"jsHooks":[]}</script>
<p>The reviews show that the data is almost clean and only anomalies
appeared in the <em>engineSize</em> variable. Additionaly, minor
formatting issues in the <em>model</em> variable have been
standardized.</p>
<p>Additionally, text variables were defined as factors.</p>
<div id="missing-values" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Missing Values</h3>
There are no missing values in the Dataset.
<table class=" lightable-classic" style="color: black; font-family: Cambria; width: auto !important; ">
<caption>
Missing Values
</caption>
<thead>
<tr>
<th style="text-align:right;">
model
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
price
</th>
<th style="text-align:right;">
transmission
</th>
<th style="text-align:right;">
mileage
</th>
<th style="text-align:right;">
fuelType
</th>
<th style="text-align:right;">
tax
</th>
<th style="text-align:right;">
mpg
</th>
<th style="text-align:right;">
engineSize
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
<div id="text-variables-validation" class="section level3"
number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Text Variables
Validation</h3>
<p>A review of the text-type variables reveals that the <em>model</em>
field contains strings with spaces, which need to be corrected for
further analysis. It is also noted that the strings do not contain
special characters, except for the “-” sign, which does not pose any
issues. Finally, an inconsistency is observed in the string <em>PROACE
VERSO</em>, as it is in uppercase letters, unlike the rest of the
models.</p>
<table class=" lightable-classic" style="color: black; font-family: Cambria; width: auto !important; ">
<caption>
Unique Strings
</caption>
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:left;">
Levels
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
model
</td>
<td style="text-align:left;">
GT86, Corolla, RAV4, Yaris, Auris, Aygo, C-HR, Prius, Avensis, Verso,
Hilux, PROACE VERSO, Land Cruiser, Supra, Camry, Verso-S, IQ, Urban
Cruiser
</td>
</tr>
<tr>
<td style="text-align:left;">
transmission
</td>
<td style="text-align:left;">
Manual, Automatic, Semi-Auto, Other
</td>
</tr>
<tr>
<td style="text-align:left;">
fuelType
</td>
<td style="text-align:left;">
Petrol, Other, Hybrid, Diesel
</td>
</tr>
</tbody>
</table>
<p>Once the spacing and formatting issues have been corrected, the text
variables will be transformed to be used as factors for further
analysis.</p>
<p>Since economic processes like inflation or asset depreciation occur
continuously over time, date data should be treated as integer-type
numeric data. Therefore, the <em>year</em> field will not be converted
into a factor.</p>
</div>
<div id="numeric-variables-validation" class="section level3"
number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Numeric Variables
Validation</h3>
In numeric variables, the review consists of locating atypical values:
negative values and zero values.
<table class=" lightable-classic" style="color: black; font-family: Cambria; width: auto !important; ">
<caption>
Number of Negative Values
</caption>
<thead>
<tr>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
price
</th>
<th style="text-align:right;">
mileage
</th>
<th style="text-align:right;">
tax
</th>
<th style="text-align:right;">
mpg
</th>
<th style="text-align:right;">
engineSize
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<table class=" lightable-classic" style="color: black; font-family: Cambria; width: auto !important; ">
<caption>
Number of Zero Values
</caption>
<thead>
<tr>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
price
</th>
<th style="text-align:right;">
mileage
</th>
<th style="text-align:right;">
tax
</th>
<th style="text-align:right;">
mpg
</th>
<th style="text-align:right;">
engineSize
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1790
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
</tr>
</tbody>
</table>
Zero values in the tax field do not exhibit any unusual patterns, and
most instances correspond to hybrid models. It is plausible to consider
these as cases of government incentives, which do not require any
correction.
<table class=" lightable-classic" style="color: black; font-family: Cambria; width: auto !important; ">
<caption>
Tipos de vehículo con Tax = 0
</caption>
<thead>
<tr>
<th style="text-align:left;">
fuelType
</th>
<th style="text-align:right;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 150px; ">
Diesel
</td>
<td style="text-align:right;">
27
</td>
</tr>
<tr>
<td style="text-align:left;width: 150px; ">
Hybrid
</td>
<td style="text-align:right;">
995
</td>
</tr>
<tr>
<td style="text-align:left;width: 150px; ">
Other
</td>
<td style="text-align:right;">
27
</td>
</tr>
<tr>
<td style="text-align:left;width: 150px; ">
Petrol
</td>
<td style="text-align:right;">
741
</td>
</tr>
</tbody>
</table>
On the other hand, since an engine’s size cannot be zero, this is
clearly an error in the data. The necessary correction involves
identifying the patterns of the six exceptions found.
<table class=" lightable-classic" style="color: black; font-family: Cambria; width: auto !important; ">
<caption>
Anomaly engineSize = 0
</caption>
<thead>
<tr>
<th style="text-align:left;">
model
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
price
</th>
<th style="text-align:left;">
transmission
</th>
<th style="text-align:right;">
mileage
</th>
<th style="text-align:left;">
fuelType
</th>
<th style="text-align:right;">
tax
</th>
<th style="text-align:right;">
mpg
</th>
<th style="text-align:right;">
engineSize
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Yaris
</td>
<td style="text-align:right;">
2016
</td>
<td style="text-align:right;">
12300
</td>
<td style="text-align:left;">
Manual
</td>
<td style="text-align:right;">
6148
</td>
<td style="text-align:left;">
Hybrid
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
86.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Yaris
</td>
<td style="text-align:right;">
2016
</td>
<td style="text-align:right;">
11000
</td>
<td style="text-align:left;">
Automatic
</td>
<td style="text-align:right;">
39909
</td>
<td style="text-align:left;">
Hybrid
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
86.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Aygo
</td>
<td style="text-align:right;">
2019
</td>
<td style="text-align:right;">
9800
</td>
<td style="text-align:left;">
Manual
</td>
<td style="text-align:right;">
3635
</td>
<td style="text-align:left;">
Petrol
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
56.5
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Aygo
</td>
<td style="text-align:right;">
2019
</td>
<td style="text-align:right;">
8000
</td>
<td style="text-align:left;">
Manual
</td>
<td style="text-align:right;">
8531
</td>
<td style="text-align:left;">
Petrol
</td>
<td style="text-align:right;">
145
</td>
<td style="text-align:right;">
56.5
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Aygo
</td>
<td style="text-align:right;">
2019
</td>
<td style="text-align:right;">
8000
</td>
<td style="text-align:left;">
Manual
</td>
<td style="text-align:right;">
5354
</td>
<td style="text-align:left;">
Petrol
</td>
<td style="text-align:right;">
145
</td>
<td style="text-align:right;">
56.5
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
C-HR
</td>
<td style="text-align:right;">
2017
</td>
<td style="text-align:right;">
14300
</td>
<td style="text-align:left;">
Manual
</td>
<td style="text-align:right;">
46571
</td>
<td style="text-align:left;">
Petrol
</td>
<td style="text-align:right;">
145
</td>
<td style="text-align:right;">
47.1
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
The details reveal that these cases share the variables <em>model</em>,
<em>year</em>, and <em>fuelType</em>. Therefore, filtering by each of
these groups will help narrow down the variants.
<table class=" lightable-classic" style="color: black; font-family: Cambria; width: auto !important; ">
<caption>
Options where engineSize = 0
</caption>
<thead>
<tr>
<th style="text-align:left;">
model
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:left;">
fuelType
</th>
<th style="text-align:right;">
engineSize
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Yaris
</td>
<td style="text-align:right;">
2016
</td>
<td style="text-align:left;">
Hybrid
</td>
<td style="text-align:right;">
1.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Yaris
</td>
<td style="text-align:right;">
2016
</td>
<td style="text-align:left;">
Hybrid
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Aygo
</td>
<td style="text-align:right;">
2019
</td>
<td style="text-align:left;">
Petrol
</td>
<td style="text-align:right;">
1.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Aygo
</td>
<td style="text-align:right;">
2019
</td>
<td style="text-align:left;">
Petrol
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
C-HR
</td>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
Petrol
</td>
<td style="text-align:right;">
1.2
</td>
</tr>
<tr>
<td style="text-align:left;">
C-HR
</td>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
Petrol
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
C-HR
</td>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
Petrol
</td>
<td style="text-align:right;">
1.8
</td>
</tr>
</tbody>
</table>
Only the <em>C-HR</em> model presents more than one possibility, so it
is necessary to expand the grouping with the <em>transmission</em>
variable.
<table class=" lightable-classic" style="color: black; font-family: Cambria; width: auto !important; ">
<caption>
C-HR exception
</caption>
<thead>
<tr>
<th style="text-align:left;">
model
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:left;">
transmission
</th>
<th style="text-align:left;">
fuelType
</th>
<th style="text-align:right;">
engineSize
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
C-HR
</td>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
Manual
</td>
<td style="text-align:left;">
Petrol
</td>
<td style="text-align:right;">
1.2
</td>
</tr>
<tr>
<td style="text-align:left;">
C-HR
</td>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
Manual
</td>
<td style="text-align:left;">
Petrol
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
</tbody>
</table>
This approach allows for corrections to the <em>engineSize</em> variable
in all six cases by separately addressing the two types of actual value
identification.
<table class=" lightable-classic" style="color: black; font-family: Cambria; width: auto !important; ">
<caption>
Corrections where engineSize = 0
</caption>
<thead>
<tr>
<th style="text-align:left;">
model
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:left;">
transmission
</th>
<th style="text-align:right;">
mileage
</th>
<th style="text-align:left;">
fuelType
</th>
<th style="text-align:right;">
tax
</th>
<th style="text-align:right;">
mpg
</th>
<th style="text-align:right;">
engineSize
</th>
<th style="text-align:right;">
price
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Yaris
</td>
<td style="text-align:right;">
2016
</td>
<td style="text-align:left;">
Manual
</td>
<td style="text-align:right;">
6148
</td>
<td style="text-align:left;">
Hybrid
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
86.0
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
12300
</td>
</tr>
<tr>
<td style="text-align:left;">
Yaris
</td>
<td style="text-align:right;">
2016
</td>
<td style="text-align:left;">
Automatic
</td>
<td style="text-align:right;">
39909
</td>
<td style="text-align:left;">
Hybrid
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
86.0
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
11000
</td>
</tr>
<tr>
<td style="text-align:left;">
Aygo
</td>
<td style="text-align:right;">
2019
</td>
<td style="text-align:left;">
Manual
</td>
<td style="text-align:right;">
3635
</td>
<td style="text-align:left;">
Petrol
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
56.5
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
9800
</td>
</tr>
<tr>
<td style="text-align:left;">
Aygo
</td>
<td style="text-align:right;">
2019
</td>
<td style="text-align:left;">
Manual
</td>
<td style="text-align:right;">
8531
</td>
<td style="text-align:left;">
Petrol
</td>
<td style="text-align:right;">
145
</td>
<td style="text-align:right;">
56.5
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
8000
</td>
</tr>
<tr>
<td style="text-align:left;">
Aygo
</td>
<td style="text-align:right;">
2019
</td>
<td style="text-align:left;">
Manual
</td>
<td style="text-align:right;">
5354
</td>
<td style="text-align:left;">
Petrol
</td>
<td style="text-align:right;">
145
</td>
<td style="text-align:right;">
56.5
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
8000
</td>
</tr>
<tr>
<td style="text-align:left;">
C-HR
</td>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
Manual
</td>
<td style="text-align:right;">
46571
</td>
<td style="text-align:left;">
Petrol
</td>
<td style="text-align:right;">
145
</td>
<td style="text-align:right;">
47.1
</td>
<td style="text-align:right;">
1.2
</td>
<td style="text-align:right;">
14300
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="exploratory-analysis" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Exploratory
Analysis</h2>
<p>Preliminary analysis is performed in file <em>03_explore.R</em></p>
<div id="htmlwidget-dd256e747898da2b0784" style="width:100%;height:100%;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-dd256e747898da2b0784">{"x":{"diagram":"\n    graph LR\n        A[Dataset Overview]\n        A --> B[Target Description]\n        B --> C[Variables Description]\n    "},"evals":[],"jsHooks":[]}</script>
<div id="dataset-overview" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Dataset
Overview</h3>
<p>The dataset comprises 9 variables and 6738 observations, with a total
size of 0.5 Mb.</p>
This is a random sample that replicates the functionality of the
<em>glimpse</em> function.
<table class=" lightable-classic" style="color: black; font-family: Cambria; width: auto !important; ">
<caption>
Data Overview
</caption>
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:left;">
Values
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
model
</td>
<td style="text-align:left;">
Yaris, Corolla, Aygo, Corolla, Yaris, Aygo, C-HR, Yaris, Aygo, Aygo
</td>
</tr>
<tr>
<td style="text-align:left;">
year
</td>
<td style="text-align:left;">
2008, 2014, 2017, 2019, 2019, 2015, 2019, 2015, 2016, 2017
</td>
</tr>
<tr>
<td style="text-align:left;">
price
</td>
<td style="text-align:left;">
7795, 10740, 6995, 16495, 8895, 11995, 9300, 8980, 17995, 25650
</td>
</tr>
<tr>
<td style="text-align:left;">
transmission
</td>
<td style="text-align:left;">
Automatic, Manual, Manual, Manual, Manual, Automatic, Automatic,
Automatic, Manual, Automatic
</td>
</tr>
<tr>
<td style="text-align:left;">
mileage
</td>
<td style="text-align:left;">
40681, 32754, 7620, 38876, 20718, 21000, 7670, 30130, 9275, 24512
</td>
</tr>
<tr>
<td style="text-align:left;">
fuelType
</td>
<td style="text-align:left;">
Petrol, Hybrid, Petrol, Petrol, Petrol, Petrol, Petrol, Petrol, Petrol,
Petrol
</td>
</tr>
<tr>
<td style="text-align:left;">
tax
</td>
<td style="text-align:left;">
30, 145, 145, 0, 0, 140, 145, 145, 145, 0
</td>
</tr>
<tr>
<td style="text-align:left;">
mpg
</td>
<td style="text-align:left;">
68.9, 56.5, 65.7, 52.3, 53, 76.3, 52.3, 74.3, 56.5, 86
</td>
</tr>
<tr>
<td style="text-align:left;">
engineSize
</td>
<td style="text-align:left;">
1.5, 2, 1.3, 1.8, 1, 1.6, 1.6, 1.8, 1, 1.8
</td>
</tr>
</tbody>
</table>
<table class=" lightable-classic" style="color: black; font-family: Cambria; width: auto !important; ">
<caption>
Overview variables
</caption>
<thead>
<tr>
<th style="text-align:left;">
variable
</th>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
NA
</th>
<th style="text-align:right;">
Unique
</th>
<th style="text-align:right;">
Min
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
Max
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
model
</td>
<td style="text-align:left;">
factor
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
year
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
1998
</td>
<td style="text-align:right;">
2017
</td>
<td style="text-align:right;">
2020
</td>
</tr>
<tr>
<td style="text-align:left;">
transmission
</td>
<td style="text-align:left;">
factor
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
mileage
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5699
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
22857
</td>
<td style="text-align:right;">
174419
</td>
</tr>
<tr>
<td style="text-align:left;">
fuelType
</td>
<td style="text-align:left;">
factor
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
tax
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
565
</td>
</tr>
<tr>
<td style="text-align:left;">
mpg
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
81
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
235
</td>
</tr>
<tr>
<td style="text-align:left;">
engineSize
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
price
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2114
</td>
<td style="text-align:right;">
850
</td>
<td style="text-align:right;">
12522
</td>
<td style="text-align:right;">
59995
</td>
</tr>
</tbody>
</table>
</div>
<div id="variable-classification" class="section level3" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Variable
Classification</h3>
This classification according to the nature of the variables is useful
throughout the different analyses.
<table class=" lightable-classic" style="color: black; font-family: Cambria; width: auto !important; ">
<caption>
Variables Overview
</caption>
<thead>
<tr>
<th style="text-align:left;">
Tipo
</th>
<th style="text-align:left;">
Variables
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
target
</td>
<td style="text-align:left;">
price
</td>
</tr>
<tr>
<td style="text-align:left;">
categorical
</td>
<td style="text-align:left;">
model, transmission, fuelType
</td>
</tr>
<tr>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
year, mileage, tax, mpg, engineSize
</td>
</tr>
</tbody>
</table>
</div>
<div id="target-description" class="section level3" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Target
Description</h3>
<img src="Exam_files/figure-html/target-distribution-figure-1.png" width="864" style="display: block; margin: auto auto auto 0;" />
As can be seen, this is a bimodal distribution skewed to the right (Mean
&gt; Median), with positive values. Some statistics of the empirical
distribution are described.
<table class=" lightable-classic" style="color: black; font-family: Cambria; width: auto !important; ">
<caption>
Target Statistics
</caption>
<thead>
<tr>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
Min
</th>
<th style="text-align:right;">
P25
</th>
<th style="text-align:right;">
Median
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
P75
</th>
<th style="text-align:right;">
Max
</th>
<th style="text-align:right;">
StdDesv
</th>
<th style="text-align:right;">
IQR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
850
</td>
<td style="text-align:right;">
8290
</td>
<td style="text-align:right;">
10795
</td>
<td style="text-align:right;">
12522
</td>
<td style="text-align:right;">
14995
</td>
<td style="text-align:right;">
59995
</td>
<td style="text-align:right;">
6345
</td>
<td style="text-align:right;">
6705
</td>
</tr>
</tbody>
</table>
<p>This type of distribution in the dependent variable has important
implications, as it can affect the validity of the assumptions
underlying the classical Linear Regression model (OLM). These
assumptions include the normality of the residuals and homoscedasticity
(constant variance of the errors). A right skew indicates that the data
are not symmetric, which can lead to standard errors that violate the
assumptions of normality in the residuals and homoscedasticity,
resulting in unreliable inferences. In such cases, one might consider
transforming the dependent variable, often using a logarithmic
transformation, or employing alternative models such as Generalized
Linear Regression (GLM) with a Gamma link function, which is commonly
used when the dependent variable is a price.</p>
</div>
<div id="numeric-variables-exploration" class="section level3"
number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> Numeric Variables
Exploration</h3>
<p>The numerical variables exhibit the following distributions:
<img src="Exam_files/figure-html/numeric-variables-distribution-1.png" width="864" style="display: block; margin: auto auto auto 0;" />
<img src="Exam_files/figure-html/numeric-distribution-figure-1.png" width="864" style="display: block; margin: auto auto auto 0;" />
LOESS smoothing is useful for illustrating the relationship between
numerical variables and the target variable (price), highlighting
non-linear relationships and non-constant variances. Interestingly, the
<em>mileage</em> variable exhibits a quasi-linear response, likely due
to the low number of data points at the right end of the
distribution.</p>
<p><img src="Exam_files/figure-html/numeric-vars-target-1.png" width="864" style="display: block; margin: auto auto auto 0;" />
To adapt the <em>year</em> variable, although it can be considered an
ordered categorical variable, it should be treated as a numeric variable
and, therefore, does not require transformation.</p>
</div>
<div id="categorical-variables" class="section level3" number="3.3.5">
<h3><span class="header-section-number">3.3.5</span> Categorical
Variables</h3>
<p>Review of the categorical variable levels shows the uneven
distribution of variables with multiple <em>model</em> levels, and very
low frequencies in the <em>fuelType</em> and <em>transmission</em>
variables. This anticipates overfitting problems.</p>
<p>Here’s an improved version of your sentence:</p>
A review of the categorical variable levels unveals an uneven
distribution among variables with multiple <em>model</em> levels and
very low frequencies in the <em>fuelType</em> and <em>transmission</em>
variables. This imbalance suggests potential overfitting problems.
<table class=" lightable-classic table" style="color: black; font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto; color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Levels Overview
</caption>
<thead>
<tr>
<th style="text-align:left;">
variable
</th>
<th style="text-align:left;">
levels_freq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
fuelType
</td>
<td style="text-align:left;">
Petrol(60.7%), Hybrid(30.3%), Diesel(7.5%), Other(1.6%)
</td>
</tr>
<tr>
<td style="text-align:left;">
model
</td>
<td style="text-align:left;">
Yaris(31.5%), Aygo(29.1%), Auris(10.6%), C-HR(7.1%), RAV4(7%),
Corolla(4%), Prius(3.4%), Avensis(1.7%), Verso(1.7%), Hilux(1.3%),
GT86(1.1%), Land_Cruiser(0.8%), Proace_Verso(0.2%), Supra(0.2%),
Camry(0.2%), IQ(0.1%), Urban_Cruiser(0.1%), Verso-S(0%)
</td>
</tr>
<tr>
<td style="text-align:left;">
transmission
</td>
<td style="text-align:left;">
Manual(56.8%), Automatic(39.4%), Semi-Auto(3.8%), Other(0%)
</td>
</tr>
</tbody>
</table>
<p>The following box plot illustrates the distributions for each level,
with the unique feature of proportionally representing the number of
observations through the width of each box.
<img src="Exam_files/figure-html/categorical-distribution-figure-1.png" width="864" style="display: block; margin: auto auto auto 0;" />
The distribution of the <em>model</em> variable indicates that it is the
best predictor of the target variable.</p>
</div>
<div id="outliers" class="section level3" number="3.3.6">
<h3><span class="header-section-number">3.3.6</span> Outliers</h3>
<p>Although the dataset clearly contains biased values of the target
variable, and a preliminary analysis of the regression residuals reveals
outliers, no filtering is applied in this exercise, as it is deemed that
the model’s results are sufficiently precise.</p>
</div>
</div>
</div>
<div id="pre-processing-analysis" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Pre-Processing
Analysis</h1>
<div id="htmlwidget-eef60a8bd8392f19fe9b" style="width:100%;height:100%;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-eef60a8bd8392f19fe9b">{"x":{"diagram":"\n    graph LR\n        A[Correlation Analysis<br><small>./scripts/04_correlations.R<\/small>]\n        A --> B[Analysis of Variance<br><small>./scripts/05_aov.R<\/small>]\n        B --> C[Transformations]\n    "},"evals":[],"jsHooks":[]}</script>
<div id="correlation" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Correlation</h2>
<p>Vehicles are durable, complex, and expensive consumer goods,
necessitating a segmentation of characteristics that can be identified
with the model. This involves a strong relationship between mechanical
characteristics such as engine type, mechanical transmission type, fuel
type, fuel consumption rate, and year of manufacture, as well as
parameters like taxes, which are often set based on vehicle
characteristics. Additionally, usage parameters like year of manufacture
and mileage suggest a priori a high correlation, and there might even be
a relationship between specific models and certain years of
manufacture.</p>
<p>In order to determine the regressors and eliminate those that are
strongly correlated, this will help to establish more reliable
predictions.</p>
<p>The representation of the distributions suggests a negative
correlation between the variables <em>mileage</em> and <em>year</em>,
which is quite logical for vehicles.</p>
Therefore, analyzing the correlation between the variables of the
dataset is critical for correct modeling, avoiding overfitting problems.
<table class=" lightable-classic" style="color: black; font-family: Cambria; width: auto !important; ">
<caption>
Correlations among Numeric Variables
</caption>
<thead>
<tr>
<th style="text-align:left;">
x
</th>
<th style="text-align:left;">
y
</th>
<th style="text-align:right;">
r
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 120px; ">
year
</td>
<td style="text-align:left;">
mileage
</td>
<td style="text-align:right;">
-0.7277492
</td>
</tr>
<tr>
<td style="text-align:left;width: 120px; ">
tax
</td>
<td style="text-align:left;">
mpg
</td>
<td style="text-align:right;">
-0.4302916
</td>
</tr>
<tr>
<td style="text-align:left;width: 120px; ">
year
</td>
<td style="text-align:left;">
tax
</td>
<td style="text-align:right;">
0.2834552
</td>
</tr>
<tr>
<td style="text-align:left;width: 120px; ">
mileage
</td>
<td style="text-align:left;">
tax
</td>
<td style="text-align:right;">
-0.2052848
</td>
</tr>
<tr>
<td style="text-align:left;width: 120px; ">
mileage
</td>
<td style="text-align:left;">
engineSize
</td>
<td style="text-align:right;">
0.1830991
</td>
</tr>
<tr>
<td style="text-align:left;width: 120px; ">
tax
</td>
<td style="text-align:left;">
engineSize
</td>
<td style="text-align:right;">
0.1561628
</td>
</tr>
<tr>
<td style="text-align:left;width: 120px; ">
mpg
</td>
<td style="text-align:left;">
engineSize
</td>
<td style="text-align:right;">
-0.1067326
</td>
</tr>
<tr>
<td style="text-align:left;width: 120px; ">
year
</td>
<td style="text-align:left;">
engineSize
</td>
<td style="text-align:right;">
-0.0450393
</td>
</tr>
<tr>
<td style="text-align:left;width: 120px; ">
mileage
</td>
<td style="text-align:left;">
mpg
</td>
<td style="text-align:right;">
0.0448891
</td>
</tr>
<tr>
<td style="text-align:left;width: 120px; ">
year
</td>
<td style="text-align:left;">
mpg
</td>
<td style="text-align:right;">
-0.0206074
</td>
</tr>
</tbody>
</table>
<p>The data indicate a strong correlation between the variables
<em>year</em> and <em>mileage</em>, as anticipated by the distributions.
Additionally, there is a significant relationship between the variables
<em>tax</em> and <em>mpg</em>.</p>
<div id="high-correlated-variables-vs-target-variable"
class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> High Correlated
Variables vs Target Variable</h3>
Once the strong correlation between the variables <em>year</em> and
<em>mileage</em> is established, assessing their correlation with the
variable <em>price</em> will help identify which variable can be
excluded in the regression modeling process.
<table class=" lightable-classic" style="color: black; font-family: Cambria; width: auto !important; ">
<caption>
Missing Values
</caption>
<thead>
<tr>
<th style="text-align:left;">
x
</th>
<th style="text-align:left;">
y
</th>
<th style="text-align:right;">
r
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
price
</td>
<td style="text-align:left;">
year
</td>
<td style="text-align:right;">
0.4209594
</td>
</tr>
<tr>
<td style="text-align:left;">
price
</td>
<td style="text-align:left;">
mileage
</td>
<td style="text-align:right;">
-0.2979358
</td>
</tr>
<tr>
<td style="text-align:left;">
year
</td>
<td style="text-align:left;">
mileage
</td>
<td style="text-align:right;">
-0.7277492
</td>
</tr>
</tbody>
</table>
<p>In conclusion, the decision to exclude the variable <em>mileage</em>
as a regressor in the predictive models is justified, as it exhibits a
weaker relationship with the target variable.</p>
</div>
<div id="anova-and-post-hoc-tests" class="section level3"
number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> ANOVA and post-hoc
tests</h3>
<p><img src="figures/05_categorical_distr_plot.png" /><!-- --></p>
<ul>
<li>The factor <em>model</em> has the highest number of levels (18),
suggesting that it is the most diverse factor.</li>
<li>The sum of squares (<em>sumsq</em>) for <em>model</em> is the
highest, indicating that this factor may explain the majority of the
variability in prices.</li>
<li>All factors (<em>model</em>, <em>transmission</em>,
<em>fuelType</em>) show a statistically significant effect on price
(p-value = 0 for all).</li>
<li>The F-values are very high for all factors, indicating that the
differences between groups are much greater than the differences within
groups.</li>
</ul>
<p>This analysis suggests that the factor <em>model</em> is particularly
important in explaining price variability, while the other factors also
have a significant impact.</p>
</div>
</div>
<div id="transformations" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Transformations</h2>
<p>Given that the distribution of the variable <em>price</em> is skewed,
a logarithmic transformation will be applied.</p>
</div>
</div>
<div id="machine-leaning-models-analysis" class="section level1"
number="5">
<h1><span class="header-section-number">5</span> Machine Leaning Models
Analysis</h1>
<p>The purpose of the exercise is to determine a method of vehicle price
prediction. The models used were: * Linear Regression (LM) * Support
Vector Machines (SVM) * K-Nearest Neighbor (KNN) * Decision Trees (DT) *
Random Forest (RF) * Light Gradient Boosting Machine (LGB) * Extreme
Gradient Boosting (XGB) * Multilayer Perceptron (MLP)</p>
<div id="workflow-1" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Workflow</h2>
<p>Modeling within the <em>tidymodels</em> library ecosystem has a
fundamental advantage: it allows the particularities of each type of
model to be abstracted. The Process has the following workflow:</p>
<div id="htmlwidget-23f509699b3164918980" style="width:100%;height:100%;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-23f509699b3164918980">{"x":{"diagram":"\ngraph LR\n    %% Subgraph for Data Preparation\n    subgraph \n        A1[<b>Data Preparation<\/b>]\n        A2[Training/Test Set Splitting]\n        A3[Cross Validation Folds Splitting]\n    end\n    subgraph \n        B1[<b>Model Design<\/b>]\n        B21[Formula Definition]\n        B3[Data preprocessing]\n        B4[Model Definition]\n    end\n    subgraph \n        C1[<b>Building Model<\/b>]\n        C2[Training Model]\n        C3[Testing Model]\n        C4[Final Tunning]\n        C5[Final Processing]\n    end\n    \n    A1 --> B1\n    B1 --> C1\n"},"evals":[],"jsHooks":[]}</script>
<p>The code for all models is located in the file
<em>06_machine_learning_models.R</em>.</p>
<p>As a technical feature, the models were developed by replicating the
code except for the model definition, in order to allow a subsequent
analysis of each element of model individually instead of generating a
function that executes all the steps of the process where it receives as
input, the formula, the preprocessing recipe, and the description of the
model.</p>
<p>The cost of generating models in such abstract way that also involves
cross-validation for the final determination of parameters is the
intensive processing required, which is aggravated by the defects
inherent to R as a programming language without the capacity for
parallel task processing, which is why the generated models were stored
in files and avoided subsequent training.</p>
<p>The preprocessing step has been carried out according to the findings
of the preliminary analysis, consisting of the following steps:</p>
<ul>
<li>Logarithmic transformation of the dependent variable</li>
<li>Creation of dummy variables</li>
<li>Remotion of highly correlated variables</li>
<li>Remotion of variables with zero variance</li>
<li>Centering and scaling of numerical variables</li>
</ul>
</div>
<div id="results" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Results</h2>
<p><img src="figures/06_response_prediction.png" style="display: block; margin: auto auto auto 0;" /></p>
<p>The parameters used to determine the goodness of fit were:</p>
<ul>
<li>Mean Absolute Error (MAE)</li>
<li>Root Mean Squared Error (RMSE)</li>
<li>Coefficient of Determination <span
class="math inline">\(R^2\)</span> (RSQ)</li>
</ul>
<table class=" lightable-classic" style="color: black; font-family: Cambria; width: auto !important; ">
<caption>
Model Comparison
</caption>
<thead>
<tr>
<th style="text-align:left;">
model
</th>
<th style="text-align:right;">
rsq
</th>
<th style="text-align:right;">
rmse
</th>
<th style="text-align:right;">
mae
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
lgb
</td>
<td style="text-align:right;">
0.9532205
</td>
<td style="text-align:right;">
0.1024643
</td>
<td style="text-align:right;">
0.0738416
</td>
</tr>
<tr>
<td style="text-align:left;">
xgb
</td>
<td style="text-align:right;">
0.9512582
</td>
<td style="text-align:right;">
0.1044783
</td>
<td style="text-align:right;">
0.0733710
</td>
</tr>
<tr>
<td style="text-align:left;">
rf
</td>
<td style="text-align:right;">
0.9511558
</td>
<td style="text-align:right;">
0.1046745
</td>
<td style="text-align:right;">
0.0734500
</td>
</tr>
<tr>
<td style="text-align:left;">
mlp
</td>
<td style="text-align:right;">
0.9461779
</td>
<td style="text-align:right;">
0.1097645
</td>
<td style="text-align:right;">
0.0803454
</td>
</tr>
<tr>
<td style="text-align:left;">
dt
</td>
<td style="text-align:right;">
0.9446110
</td>
<td style="text-align:right;">
0.1115275
</td>
<td style="text-align:right;">
0.0772520
</td>
</tr>
<tr>
<td style="text-align:left;">
knn
</td>
<td style="text-align:right;">
0.9435963
</td>
<td style="text-align:right;">
0.1125745
</td>
<td style="text-align:right;">
0.0791371
</td>
</tr>
<tr>
<td style="text-align:left;">
svm
</td>
<td style="text-align:right;">
0.9370995
</td>
<td style="text-align:right;">
0.1198212
</td>
<td style="text-align:right;">
0.0886006
</td>
</tr>
<tr>
<td style="text-align:left;">
lm
</td>
<td style="text-align:right;">
0.9349610
</td>
<td style="text-align:right;">
0.1210425
</td>
<td style="text-align:right;">
0.0906901
</td>
</tr>
</tbody>
</table>
<p>It can be observed that the techniques <em>Light Gradient Boosting
Machine (LGB)</em> and <em>Extreme Gradient Boosting (XGB)</em> obtained
results 2% better than those that showed the worst performance
<em>Linear Regression (LM)</em> and <em>Support Vector Machines
(SVM)</em>, although the eight models present very similar results.</p>
</div>
<div id="average-predictions" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Average
Predictions</h2>
Since the prediction methods are quite different from each other,
averaging all of them could improve the metrics,
<table class=" lightable-classic" style="color: black; font-family: Cambria; width: auto !important; ">
<caption>
Average Prediction Metrics
</caption>
<thead>
<tr>
<th style="text-align:right;">
rsq
</th>
<th style="text-align:right;">
rmse
</th>
<th style="text-align:right;">
mae
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.9539775
</td>
<td style="text-align:right;">
0.1019615
</td>
<td style="text-align:right;">
0.0735698
</td>
</tr>
</tbody>
</table>
<p>Which shows a slight improvement over the best of the models.</p>
</div>
<div id="residuals" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Residuals</h2>
<p><img src="figures/06_residuals_histogram.png" style="display: block; margin: auto auto auto 0;" />
The residual plots show centered and symmetrical distributions in all
models, demonstrating the success of the preprocessing of
standardization of the numerical variables, and the logarithmic
transformation of the dependent variable.</p>
<p>Which validates the main assumption of Normality in the residuals as
a criterion for the validity of the forecasts.</p>
<p><img src="figures/06_residuals_qqplot.png" style="display: block; margin: auto auto auto 0;" />
The standard deviation of the residuals is <span
class="math inline">\(\sigma\)</span> = 0.9, which suggests a lower
variability than expected, something that can be seen in the theoretical
ranges (-3 : 3) compared to the real ranges (-0.75 : 0.75).</p>
</div>
<div id="accuracy" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Accuracy</h2>
<p>After analyzing the data and creating models that predict the price
of vehicles, it remains to determine the accuracy, since it can be
measured in different ways (in this exercise, three of them have been
used: <em>MAE</em>, <em>RMSE</em> and <em>R²</em>), in more general
terms, the measure of goodness of fit that best fits the term accuracy
is the mean absolute error (MAE).</p>
<p>Remembering the objective of the exercise:</p>
<blockquote>
<p>Analyzing the data, modeling the used vehicle price estimation with
an accuracy within 10%, and sharing the results.</p>
</blockquote>
The requirement shows some ambiguity, so I must understand that it
requests a precision with an error of less than 10%, and therefore a
precision greater than 90%.
<table class=" lightable-classic" style="color: black; font-family: Cambria; width: auto !important; ">
<caption>
Average Prediction Metrics
</caption>
<thead>
<tr>
<th style="text-align:left;">
metric
</th>
<th style="text-align:left;">
accuracy
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 150px; ">
rsq
</td>
<td style="text-align:left;">
95.40%
</td>
</tr>
<tr>
<td style="text-align:left;width: 150px; ">
rmse
</td>
<td style="text-align:left;">
89.80%
</td>
</tr>
<tr>
<td style="text-align:left;width: 150px; ">
mae
</td>
<td style="text-align:left;">
92.64%
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="sessioninfosession_info" class="section level1" number="6">
<h1><span class="header-section-number">6</span>
sessioninfo::session_info()</h1>
<pre class="r"><code>sessioninfo::session_info()</code></pre>
<pre><code>## ─ Session info ───────────────────────────────────────────────────────────────
##  setting  value
##  version  R version 4.4.0 (2024-04-24 ucrt)
##  os       Windows 11 x64 (build 22631)
##  system   x86_64, mingw32
##  ui       RTerm
##  language (EN)
##  collate  Spanish_Spain.utf8
##  ctype    Spanish_Spain.utf8
##  tz       Europe/Madrid
##  date     2024-09-02
##  pandoc   3.1.11 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)
## 
## ─ Packages ───────────────────────────────────────────────────────────────────
##  package      * version date (UTC) lib source
##  bslib          0.8.0   2024-07-29 [1] CRAN (R 4.4.1)
##  cachem         1.1.0   2024-05-16 [1] CRAN (R 4.4.0)
##  cli            3.6.3   2024-06-21 [1] CRAN (R 4.4.1)
##  colorspace     2.1-1   2024-07-26 [1] CRAN (R 4.4.1)
##  DiagrammeR   * 1.0.11  2024-02-02 [1] CRAN (R 4.4.0)
##  digest         0.6.37  2024-08-19 [1] CRAN (R 4.4.1)
##  dplyr        * 1.1.4   2023-11-17 [1] CRAN (R 4.4.0)
##  evaluate       0.24.0  2024-06-10 [1] CRAN (R 4.4.0)
##  fansi          1.0.6   2023-12-08 [1] CRAN (R 4.4.0)
##  farver         2.1.2   2024-05-13 [1] CRAN (R 4.4.0)
##  fastmap        1.2.0   2024-05-15 [1] CRAN (R 4.4.0)
##  forcats      * 1.0.0   2023-01-29 [1] CRAN (R 4.4.0)
##  generics       0.1.3   2022-07-05 [1] CRAN (R 4.4.0)
##  ggplot2      * 3.5.1   2024-04-23 [1] CRAN (R 4.4.0)
##  glue           1.7.0   2024-01-09 [1] CRAN (R 4.4.0)
##  gtable         0.3.5   2024-04-22 [1] CRAN (R 4.4.0)
##  highr          0.11    2024-05-26 [1] CRAN (R 4.4.0)
##  hms            1.1.3   2023-03-21 [1] CRAN (R 4.4.0)
##  htmltools      0.5.8.1 2024-04-04 [1] CRAN (R 4.4.0)
##  htmlwidgets    1.6.4   2023-12-06 [1] CRAN (R 4.4.0)
##  jquerylib      0.1.4   2021-04-26 [1] CRAN (R 4.4.0)
##  jsonlite       1.8.8   2023-12-04 [1] CRAN (R 4.4.0)
##  kableExtra   * 1.4.0   2024-01-24 [1] CRAN (R 4.4.1)
##  knitr          1.48    2024-07-07 [1] CRAN (R 4.4.0)
##  labeling       0.4.3   2023-08-29 [1] CRAN (R 4.4.0)
##  lattice        0.22-6  2024-03-20 [2] CRAN (R 4.4.0)
##  lifecycle      1.0.4   2023-11-07 [1] CRAN (R 4.4.0)
##  lubridate    * 1.9.3   2023-09-27 [1] CRAN (R 4.4.0)
##  magrittr       2.0.3   2022-03-30 [1] CRAN (R 4.4.0)
##  Matrix         1.7-0   2024-03-22 [2] CRAN (R 4.4.0)
##  mgcv           1.9-1   2023-12-21 [2] CRAN (R 4.4.0)
##  munsell        0.5.1   2024-04-01 [1] CRAN (R 4.4.0)
##  nlme           3.1-165 2024-06-06 [2] CRAN (R 4.4.0)
##  pillar         1.9.0   2023-03-22 [1] CRAN (R 4.4.0)
##  pkgconfig      2.0.3   2019-09-22 [1] CRAN (R 4.4.0)
##  purrr        * 1.0.2   2023-08-10 [1] CRAN (R 4.4.0)
##  R6             2.5.1   2021-08-19 [1] CRAN (R 4.4.0)
##  RColorBrewer   1.1-3   2022-04-03 [1] CRAN (R 4.4.0)
##  readr        * 2.1.5   2024-01-10 [1] CRAN (R 4.4.0)
##  rlang          1.1.4   2024-06-04 [1] CRAN (R 4.4.0)
##  rmarkdown      2.28    2024-08-17 [1] CRAN (R 4.4.1)
##  rstudioapi     0.16.0  2024-03-24 [1] CRAN (R 4.4.0)
##  sass           0.4.9   2024-03-15 [1] CRAN (R 4.4.0)
##  scales         1.3.0   2023-11-28 [1] CRAN (R 4.4.0)
##  sessioninfo    1.2.2   2021-12-06 [1] CRAN (R 4.4.1)
##  stringi        1.8.4   2024-05-06 [1] CRAN (R 4.4.0)
##  stringr      * 1.5.1   2023-11-14 [1] CRAN (R 4.4.0)
##  svglite        2.1.3   2023-12-08 [1] CRAN (R 4.3.2)
##  systemfonts    1.1.0   2024-05-15 [1] CRAN (R 4.4.0)
##  tibble       * 3.2.1   2023-03-20 [1] CRAN (R 4.4.0)
##  tidyr        * 1.3.1   2024-01-24 [1] CRAN (R 4.4.0)
##  tidyselect     1.2.1   2024-03-11 [1] CRAN (R 4.4.0)
##  tidyverse    * 2.0.0   2023-02-22 [1] CRAN (R 4.4.0)
##  timechange     0.3.0   2024-01-18 [1] CRAN (R 4.4.0)
##  tzdb           0.4.0   2023-05-12 [1] CRAN (R 4.4.0)
##  utf8           1.2.4   2023-10-22 [1] CRAN (R 4.4.0)
##  vctrs          0.6.5   2023-12-01 [1] CRAN (R 4.4.0)
##  viridisLite    0.4.2   2023-05-02 [1] CRAN (R 4.4.0)
##  visNetwork     2.1.2   2022-09-29 [1] CRAN (R 4.4.0)
##  withr          3.0.1   2024-07-31 [1] CRAN (R 4.4.1)
##  xfun           0.47    2024-08-17 [1] CRAN (R 4.4.1)
##  xml2           1.3.6   2023-12-04 [1] CRAN (R 4.4.0)
##  yaml           2.3.10  2024-07-26 [1] CRAN (R 4.4.1)
## 
##  [1] C:/Users/jmmar/AppData/Local/R/win-library/4.4
##  [2] C:/Program Files/R/R-4.4.0/library
## 
## ──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
